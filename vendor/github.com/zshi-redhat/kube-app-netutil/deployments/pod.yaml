apiVersion: v1
kind: Pod
metadata:
  name: testpod
spec:
  shareProcessNamespace: true
  containers:
  - name: container-1
    image: zenghui/kube-app-netutil 
    imagePullPolicy: IfNotPresent
    command: [ "/bin/bash", "-c", "--" ]
    args: [ "/usr/bin/server --alsologtostderr" ]
    resources:
      requests:
        cpu: 100m
        memory: 100Mi
      limits:
        cpu: 100m
        memory: 100Mi
    volumeMounts:
      - mountPath: /etc/netutil/
        name: socket
      - name: podinfo
        mountPath: /etc/podinfo
        readOnly: false
  - name: container-2
    image: zenghui/kube-app-netutil 
    imagePullPolicy: IfNotPresent
    command: [ "/bin/bash", "-c", "--" ]
    args: [ "while true; do /usr/bin/client --alsologtostderr; sleep 5; done;" ]
    resources:
      requests:
        cpu: 5
        memory: 200Mi
      limits:
        cpu: 5
        memory: 200Mi
    volumeMounts:
      - mountPath: /etc/netutil/
        name: socket
  volumes:
    - name: socket
      emptyDir: {}
    - name: podinfo
      downwardAPI:
        items:
          - path: "labels"
            fieldRef:
              fieldPath: metadata.labels
          - path: "annotations"
            fieldRef:
              fieldPath: metadata.annotations
